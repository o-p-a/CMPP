		  ｱ｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣ｵ
		  ･ファイル圧縮印刷ユーティリティ ＣＭＰＰ ･
		  ･           Made by Ken/ichiro           ･
		  ｹ｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣ｽ
						の、マニュアル☆

１．ＣＭＰＰとは何ぞや
	  ＣＭＰＰとはつまり、プリンタ用紙の節約プログラムです。文字を１６
	ドットで印刷することにより、縦方向に約２倍、横方向に２～３倍の文字数を
	詰め込むことができます。また、ページ長に合わせて改ページも行います。
	さらに行番号をつけたり、文字を太くしたりすることもできます（行番号は
	ともかく文字が太くなったからって何だっての）。

２．使用条件
	１．このプログラムはＰＣ－９８０１（ＰＣ－２８６）シリーズ専用です。
	２．プリンタはとりあえず、ＰＣ－ＰＲ系とＥＰＳＯＮ ＥＳＣ／Ｐ系、
	    それと何故かエプソンのＵＰ－１３５Ｋ(PC)に対応しています。
	３．このプログラムの出力、全角で１６×１６ドットの文字を読めるだけの
	    視力があること。

３．使用方法
	  ＣＭＰＰを使って印刷をするには、ファイル名をコマンドラインで与える
	方法と、リダイレクトやパイプを使う方法とがあります。
	まず一般的な使い方。

		書式：	A>CMPP [スイッチ] [ファイル名...]

	ファイル名には複数指定が可能。スイッチについては後述。

		例：	A>CMPP /PR /NF /LN *.BAT CONFIG.SYS

	（ＰＣ－ＰＲモードで、連続用紙に、カレントディレクトリのすべての
	.BATファイルとCONFIG.SYSを行番号をつけて印字）


	次に、リダイレクトを利用した印刷。

		書式：	A>CMPP [スイッチ] <ファイル名

	まあこれを使う人はいないだろうな。ファイルも１つしか指定できないし。
	一応こういう事もできるということで。

		例：	A>CMPP /VP /FF /HT4 <TMP

	（ＶＰモードで、ファンフォールド用紙に、タブ間隔４でTMPを印刷）


	最後に、（上と似ているが）パイプを使った印刷。

		書式：	A>[コマンド] | CMPP [スイッチ]

	これは使うときは使うかもしれない。使って！

		例：	A>DIR | CMPP /UP /A4 /BF

	（ＵＰ(PC)モードで、Ａ４単票用紙に、太文字でDIRコマンドの結果を印刷）

	※リダイレクトやパイプを使用した場合、ファイル名はSTDINになります。

４．スイッチの用法
	※CMPP /? とするとスイッチの簡単な説明がでます。
	普通に使用する場合はプリンタと用紙の種類だけ指定すればいいです。
	（逆に言うと、この２つは常に指定した方がよい）

● /PR ＰＣ－ＰＲ系モード
	  現在コンピュータにつながっているプリンタが、ＰＣ－ＰＲシリーズである
	事を、ＣＭＰＰに伝えます。段数の初期値は２です。

● /AP エプソン８０桁モード
	  プリンタの種類がＥＰＳＯＮの８０桁プリンタである事をＣＭＰＰに伝えま
	す。段数の初期値は２です。８０桁とはいっても処理は１３５桁とかわりな
	く、３段組にする事もできます。（もちろん横からはみ出します。紙がもった
	いないのでやらないようにしましょう。）既定値です。

● /VP エプソン１３５桁モード
	  段数の初期値が３であるほかは/APと同じです。これも/DNnスイッチによって
	段数を変える事が出来ます。

● /UP ＵＰ－１３５Ｋ(PC)モード
	  我らが計算技術部部室にあるプリンタに対応したモードです。このプリンタ
	はとてもすばらしい。ああすばらしい。お願いだからもう少し上の機種を。
	段数の初期値は３です。

● /FF ファンフォールド用紙指定
	  連続用紙を使用するときはこのスイッチを指定して下さい。６６行（１１
	インチ）相当で改ページをし、１ページ行数もそれに合わせます。多少の誤差
	は御容赦下さい。

● /A4 Ａ４単票用紙指定
	Ａ４縦長単票用紙モードです。ページ行数は７１行相当になります。

● /B5 Ｂ５単票用紙指定
	Ｂ５縦長単票用紙モードです。ページ行数は６１行相当になります。

● /B4 Ｂ４単票用紙指定
	  Ｂ４縦長単票用紙モードです。ページ行数は８６行相当になります。
	これも使用する機会はあまりないでしょう。

● /NF 連続用紙指定
	ロール紙などの連続用紙モードです。ページ行数は１３２行になります。
	この値は「相当」ではなく、実際に１３２行（６６×２行）印刷されます。
	約８０行相当（±５行くらいの誤差がある）になります。
	ページ長を省略したときの既定値です。

● /PIn インチ単位ページ長指定
	  上記以外の紙を使用するときは、紙の長さを測って、このスイッチを指定
	して下さい。例えば/PI5で５インチ、/PI12で１２インチになります。
	ところで、１インチは約２．５４㎝です。
	ページ長は１以上１２８以下でなくてはなりません。

● /HTn タブ間隔の指定
	  水平タブストップの間隔を指定します。１～８０の値が指定できます。
	このスイッチを省略した場合、拡張子が.C及び.Hの場合は４、それ以外は８が
	指定された事になります。

● /LPn １ページ１段行数の指定
	  １ページの１段に何行印字するかを指定します。指定しない場合ＣＭＰＰが
	「大体こんなもんだろう」と計算しますが、その計算が外れていたりしたとき
	はこれを指定してやって下さい。範囲は１～４０００までです。

● /SPn 印刷開始ページ指定
	  途中から印刷したい場合はこのスイッチを指定して下さい。
	当然ながら１より小さな値は受け付けられません。
	省略した場合ファイルの最初（１ページ）から印刷されます。

● /EPn 印刷終了ページ指定
	  あるページまでであとは印字しなくていい、というような時指定して下さい
	開始ページより小さな値は受け付けません。
	省略した場合ファイルの最後まで印刷します。

● /DNn 段組数指定
	  印刷字の段数を指定します。１～３までの値が指定できます。
	私が実験した結果、１３５桁のプリンタでも４段印刷はできませんでした。
	４８ドットプリンタなら６～７段は入るでしょうが、人間の目には到底読めな
	いことが予想されます。依って現在対応の予定はありません。

● /LN 行番号を印字
	  行番号をつけて印字します。ただし！ＰＣ－ＰＲ系８０桁プリンタでは、
	ドット密度が違うため、２段組で行番号をつけると、正常な印刷ができなく
	なります。これは、いずれ強引に改良するつもりですが。

● /BF 太文字で印字
	  これがその何のためにあるのか分からない機能です。文字フォントを
	１ドット太くして印刷します。そしたら見やすくなるかもしれない、と思って
	印刷して、先輩に見比べてもらったら、太文字の方を指さして、「こっちは
	読みずらい。」と言い放ってくれました。でもやっぱり切り捨てるのは惜しく
	て、まだ残っているのです。熱転写プリンタで見ると結構きれいですよ。

● /NH ヘッダを印刷しない
	　通常、ＣＭＰＰによる印刷では、ページの頭にファイル名・時刻・ページ番
	号がヘッダとして印刷されます。このスイッチはヘッダの印字を抑制します。

● /CO ページ数のカウント
	  このスイッチを指定すると、印刷をしません。では何をするか。
	ファイルの行数を数え、印刷に必要な紙の枚数を教えてくれます。連続用紙の
	場合は、だいたいの印字結果の長さを教えてくれます。
	ファイルを複数指定したときは、合計も教えてくれます。
	ページ数の方は結構正確なのですが、長さの方はあまり正確ではありません。
	多少の誤差は御容赦下さい。（また）

５．エラーメッセージ
	  スイッチの値に異常がみつかったときなど、ＣＭＰＰは次のエラー
	メッセージを返します。

	「変なスイッチを指定しないでください。」
	ＣＭＰＰの解釈できないスイッチを指定したとき。

	「ファイルが見つからないのですが。」
	存在しないファイルを指定したとき。

	「あまり複雑なことをさせないでください。」
	タブ間隔が１～８０の間にないとき。

	「変わった紙があるんですな。」
	ページ長が１～１２８の間にないとき。

	「ヘッダだけ無限に印刷するのですか？」
	１ページ行数が１～４０００の間にないとき。

	「反転印刷なんて機能はついてないんです。」
	開始ページ、終了ページ指定に矛盾があるとき。
	（実は、バグのせいで反転印刷ができたときがあった。日に透かすと正常な文
	  字になったものだ。その時すでにこのエラーメッセージは入っていた）

	「そういう印刷はしない方があなたのためです。」
	段数が１～３の間にないとき。

６．このプログラムができるまでの過程

なごやかな雰囲気。コタツに入ってリストを眺めている僕。隣でサントリー角の水割り
を飲んでいるお父さん。

	▽ある日、僕がプリンタで打ったリストを眺めていたら、お父さんが横からリ
	　ストをのぞき込み、「ここには何も印字しないのか？」と聞きました。僕が
	　そのとき見ていたプログラムは、１行が比較的短く、用紙の右半分が
	　ほとんどあいていました。この日、僕は、これを何とかしようと思い立った
	　のです。

	▽数週間後、ＣＭＰＰの原型が完成。この当時は、エプソンのプリンタのみ
	　対応で、プリンタに１２ＣＰＩ縮小モードのコードを送って印刷していた。

	▽１／４角文字を使用して、縦方向にも圧縮する事に成功。漢字とＡＮＫの
	　バランスの悪さに悩む。

	▽次に、ＰＣ－ＰＲ系に移植を試みる。縮小モードがないのに悩む。
	　文字フォントを読みだし、ビットイメージを出力することで解決。
	　このときより、２種類のＣＭＰＰが存在するようになる。

	▽できあがったＣＭＰＰを学校に持ち込む。学校のＶＰ－１３５０は
	　１３５桁だがＣＭＰＰは２段組しかできない。また部室のＵＰ－１３５Ｋ
	　では正常な印刷ができない。いつもＥＳＣ／Ｐ用とＰＣ－ＰＲ用を持ち歩く
	　事に不満が生ずる。

	▽「こいつらを一気に解決しよう」と決心。後に「怒涛のバージョンアップ
	　事件」と呼ばれる（わけがない）。

	▽エプソンのプリンタでもビットイメージを出力するように改造（その方が読
	　みやすいと思った）。自分の周りにあるプリンタすべてに対応。ページ長を
	　設定。開始ページ、終了ページを指定できるよう改造。

	▽段組数を指定できるように改造。行番号をつけられるよう改造。太文字にも
	　なるよう改造。（それがどうした）ここまでで一応の新ＣＭＰＰが完成。

	▽行の切り出し時にバグがあったのを修正。このバグは実にしつこかった。
	　部活の最中に後ろの方でひたすらガリガリとプリンタを使っているのはとて
	　も気が引ける。(90-06-08)(90-06-15)

	▽半角漢字の出力時にバグがあったのを修正。
	　でもね、半角漢字や外字に対応しているだけでも、珍しいんだよ。
	　(90-06-14)　(90-07-17)

	▽/COスイッチを追加。(90-06-14)

	▽１文字出力時の計算に剰余算でなくシフトを使用して、速くなるかなーと
	　思ったんだけど、あまり変わらなかった。(90-06-28)

	▽太文字のアルゴリズムを改良して、より読みやすく改良。ここまで太文字に
	　固執する理由はなんだ。(90-06-28)

	▽合計の計算にバグがあったのを修正。(90-07-02)

	▽このマニュアル中で、/PR を /PC と書いた間違いがあったのを修正。
	　(92-1-10)

	▽ＬＳＩＣの試食版を手に入れたのでＣＭＰＰを移植してみる。
	　スイッチのプレフィクスにハイフンが使えなかったバグ（仕様？）を修正。
	　プリンタ種別の初期値を ＥＳＣ／Ｐ ８０桁モードに変更。なぜかという
	　と、うちにあるプリンタがそうだから。
	　連続用紙の行数の初期値を１３２に変更。
	　フォーマッタで整形されたドキュメントとぴったりあいます。(92-1-18)

	▽ページ長のエラーチェックが大ボケだったのを修正。
	　いくつか細かいところを修正。(92-1-22)

	▽/NHスイッチを追加。

	▽ＮＩＦＴＹに初アップ。(92-7-16)

そして現在に至る。


７．使用上の注意
	○このプログラムは、ＬＺＥＸＥで圧縮されています。

	○前にも言いましたけど、近眼など視力の悪い人は、このプログラムを使用
	　することはあまり勧められません。よけい目が悪くなる恐れがあります。

	○現在のＣＭＰＰでは、４０００行（表示行換算）を越えるファイルは印刷
	　できません。もし４０００行を越えるファイルを指定したときは、ファイル
	　の最初から４０００行のみが印刷されます。警告も出る予定です。開始
	　ページを後の方に指定しても、４０００行以上は決して印刷することはでき
	　ません。直す気になったら直します。

	○プログラム内ではすべて整数演算をしています。そのため、１ページ行数の
	　計算や、必要な用紙長の計算などで誤差が出ることがあります。

	○処理が２パスなので、印刷を始めるまでにちょっと時間がかかります。

	○同じ理由で、キャラクタデバイスは印刷することができません。

	○改ページやエスケープシーケンスなどはサポートされていません。改ページ
	　は、「なるたけプリンタ用紙を節約する」というコンセプトに添わないので､
	　エスケープシーケンスはこりだすときりがないので、今後もサポートの予定
	　はありません。

	○ＵＰ－１３０(PC)モードの時は、ＰＲシリーズとのドット密度の違いに
	　より、文字の線の太さがまちまちになります。
	　しかし、そんなプリンタまだ使ってるところあるのかしら。

	○ファイルの最後のページがＥＯＦだけの行で、実質何も印刷されないページ
	　がでてきても決して怒ってはいけません。ＣＭＰＰを使わなければその数倍
	　の紙が必要になったのですから。

	○インクリボンの上半分だけ妙に薄い、という状態にならないように気を付け
	　ましょう。でもリボンってメビウスになってて心配ないかもしれない。

８．その他
	★著作権主張：
	　ＣＭＰＰの複写・配布は自由とします。転載する場合は一言私まで教えて下
	　さい。ＣＭＰＰによって金銭的・またはこれに準ずる利益を得る場合には、
	　作者の承諾を必要とします。
	　作者はＣＭＰＰにバグが発見された場合これを修正する義務を負いません。
	　プログラム及びドキュメントの改変は固くこれを禁じます。

	★ＣＭＰＰはシェアウェアではありませんが、現金にかぎらず寄付（報酬）は
	　ありがたくいただきます。ただ生ものやカミソリの類は遠慮させていただき
	　ます。作者本人はこのプログラムには１人500円ほどの価値があると思ってい
	　ます。物ではなく感謝のメールでも結構です。
	　なおこれは寄付（報酬）を要求するものではあっても強制するものではあり
	　ません。金額を指定するものでもありません。

	★作者はＮＩＦＴＹの会議室は滅多に見ないので、連絡はメールで。
	　誹謗・中傷でなければどんなことでも結構です。辛口の注文も歓迎します。

	★このプログラムを使用する事によって生じた如何なる不都合にも（例えば
	　酔っぱらって気分が悪くなったとか）、作者は責任を負いません。

					　製作・著作

					  CREATE-NET 2	#554/おぱ
					   NIFTY-SERVE	HGF00102/片岡憲一郎
					  PROJECTαNET	ANET0456
					    TOPCOM-NET	#214

						おぱ (Ken/ichiro || OPA)
おしまい。
